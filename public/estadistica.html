<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" lang="en">
  <title>Dime Tu Traba/Estadística</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-3.3.6-dist/css/bootstrap.min.css" /> 
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/css/dataTables.bootstrap.min.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/css/responsive.bootstrap.min.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/css/dataTables.bootstrap.partial.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/css/bootstrap-datepicker3.min.css" />          
  <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,200,300,500,700,800' rel='stylesheet' type='text/css'> 
	<link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/views/layout/default/css/site.css" /> 
  <!--JS--> 
	<script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery/jquery-1.12.3.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery/jquery.number.min.js"></script>
	<script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-3.3.6-dist/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/js/dataTables.bootstrap.min.js"></script>    
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/js/dataTables.responsive.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/js/responsive.bootstrap.min.js"></script>      
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/js/bootstrap-datepicker.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/locales/bootstrap-datepicker.es.min.js"></script> 
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery.inputmask/inputmask.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/plugin-paginate/responsive-paginate.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootbox/bootbox.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
  <style type="text/css">
    .header-back{
      background-color: #FF3C09;
      height: 13.6rem;
    }
    .header-back h3 {
      color: white;
      margin-top: 4rem;
    }
    .fondo-img img{
      margin-top: -14rem;
    }
    .fondo-img {
      height: 0;
      border-top: 13.6rem solid #fff;
      border-right: 21rem solid transparent;
    }
    /*responsive*/
    @media screen and (max-width: 767px) {
      .header-back {
        height: 19.6rem;
      }
      .header-back h3 {
        color: white;
        font-size: 1em;
              margin: 1.5rem;
        text-align: center;
      }
      .header-back {
        margin-left: 0;
        margin-right: 0;
      }        
      .fondo-img {
        height: 0;
        border-right: 0rem solid transparent;
        text-align: center;
      } 
    }
  </style>
  <header class="header-back">
    <div class="col-sm-3 fondo-img">
      <img src="http://i63.tinypic.com/azgvtd.png " alt="dime-tu-traba">
    </div>
    <div class="col-sm-5 col-sm-offset-3 text-right header-text">
      <h3>¡Ayúdanos a identificar las trabas que se te presentan en tu día a día!</h3>
    </div>
  </header>
	<script type="text/javascript">
  const BASE_URL = "http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/";
  </script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    
    function drawChart(){
      $.getJSON( "demo.json", function( data ) {
      traba(data);
      });
    }
    
    function traba(dataReporte){
      var listaRegistrosReporte = dataReporte["Hoja1"];
      var numRegistrosInvalidos = 0;
      var numRegistrosValidos = 0;
      var numRegistrosNoTraba = 0;
      var numRegistrosInvalidoRepetido = 0
      var numRegistrosQueja = 0
      var totalRegistros = 0;
      //recorro todos los registros de la hoja1
      listaRegistrosReporte.forEach(function(registro){
        console.log(registro);
        console.log(registro.id_detalle);//prueba 
        console.log(registro.detalle_oficina);
        switch(registro.desc_VALIDAR){ //segun su descripcion, aumento el contador que corresponda
          case "INVALIDO": numRegistrosInvalidos++; break; 
          case "VALIDO": numRegistrosValidos ++; break; 
          case "NO ES TRABA":numRegistrosNoTraba++;break;
          case "INVALIDO REPETIDO":numRegistrosInvalidoRepetido++;break;
          case "QUEJA":numRegistrosQueja++;break;
          default:;
        }
      });
      totalRegistros =  numRegistrosInvalidos + numRegistrosValidos + numRegistrosNoTraba + numRegistrosInvalidoRepetido + numRegistrosQueja;
      var cantidadRegistro = (numRegistrosInvalidos*100)/totalRegistros;
      var dataGrafico = [
        ['Descripcion', 'Cantidad'], 
        ['Invalido',     numRegistrosInvalidos], 
        ['Validos',      numRegistrosValidos],
        ['No es Traba',  numRegistrosNoTraba],
        ['Invalido Repetido',  numRegistrosInvalidoRepetido],
        ['Queja',  numRegistrosQueja]
      ]
    //y agregro el array al metodo de googlechart

      var data = google.visualization.arrayToDataTable(dataGrafico);
        var options = {
          title: 'Total de registros =' +  " " + totalRegistros
        };
        var chart = new google.visualization.PieChart(document.getElementById('piechart'));
      chart.draw(data, options);
      }

    </script>	
    <div id="piechart" style="width: 900px; height: 500px;"></div>
    <div id="piechart_3d" style="width: 900px; height: 500px;"></div>
  </body>
</html>