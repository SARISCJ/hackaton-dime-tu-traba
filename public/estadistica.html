<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" lang="en">
  <title>Dime Tu Traba/Estad√≠stica</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-3.3.6-dist/css/bootstrap.min.css" /> 
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/css/dataTables.bootstrap.min.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/css/responsive.bootstrap.min.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/css/dataTables.bootstrap.partial.css" />  
  <link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/css/bootstrap-datepicker3.min.css" />          
  <link href='https://fonts.googleapis.com/css?family=Work+Sans:400,200,300,500,700,800' rel='stylesheet' type='text/css'> 
	<link rel="stylesheet" href="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/views/layout/default/css/site.css" /> 
  <!--JS--> 
	<script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery/jquery-1.12.3.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery/jquery.number.min.js"></script>
	<script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-3.3.6-dist/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/media/js/dataTables.bootstrap.min.js"></script>    
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/js/dataTables.responsive.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/DataTables-1.10.12/extensions/Responsive/js/responsive.bootstrap.min.js"></script>      
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/js/bootstrap-datepicker.min.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootstrap-datepicker-1.6.1-dist/locales/bootstrap-datepicker.es.min.js"></script> 
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/jquery.inputmask/inputmask.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/plugin-paginate/responsive-paginate.js"></script>
  <script type="text/javascript" src="http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/libs/bootbox/bootbox.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
	<script type="text/javascript">
  const BASE_URL = "http://www.produce.gob.pe/ConsultasEnLinea/consultas.web/";
  </script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart']});
    google.charts.setOnLoadCallback(drawChart);
    function drawChart(){
      $.ajax({
        url: "https://localhost:1234/demo.json",
        type: "GET",
        success:  success
      });
    function() {
          var listaRegistrosReporte = dataReporte["Hoja1"];
          var numRegistrosInvalidos = 0;
          var numRegistrosValidos = 0;
          var numRegistrosNoTraba = 0;
          var totalRegistros = 0;
            //recorro todos los registros de la hoja1
          listaRegistrosReporte.forEach(function(registro){
            console.log(registro);
            console.log(registro.id_detalle);//prueba 
            switch(registro.desc_VALIDAR){ //segun su descripcion, aumento el contador que corresponda
              case "INVALIDO": numRegistrosInvalidos++; break; 
              case "VALIDO": numRegistrosValidos ++; break; 
              case "NO ES TRABA":numRegistrosNoTraba++;break;
              default:;
            };
          });
        };
      });

      totalRegistros =  numRegistrosInvalidos + numRegistrosValidos + numRegistrosNoTraba;
      var cantidadRegistro = (numRegistrosInvalidos*100)/totalRegistros;
      // alert(totalRegistros);
      //creo el array de array  que sera la data que se transformara en grafico
      var dataGrafico = [
        ['Descripcion', 'Cantidad'], 
        ['Invalido',     numRegistrosInvalidos], 
        ['Validos',      numRegistrosValidos],
        ['No es Traba',  numRegistrosNoTraba]
      ]
      //y agregro el array al metodo de googlechart
      var data = google.visualization.arrayToDataTable(dataGrafico);
      var options = {
        title: 'Total de registros =' +  " " + totalRegistros
      };
      var chart = new   google.visualization.PieChart(document.getElementById('piechart'));
      chart.draw(data, options);
      //DONDE HAY MAS TRABAS 
      var numregistroGobiernoRegional = 0;
      var numRegistroMinisterios = 0;
      var numRegistroMunicipalidades = 0;
      var numRegistroOrganismos = 0;
      var numRegistroOtros = 0;
      var totalRegistros = 0;
        //recorro todos los registros de la hoja1
      listaRegistrosReporte.forEach(function(entidad){
        console.log(entidad);
        console.log(entidad.detalle_oficina);//prueba 
        switch(entidad.desc_VALIDAR){ //segun su descripcion, aumento el contador que corresponda
          case "GOBIERNO REGIONAL": numregistroGobiernoRegional++; break;
          case "MINISTERIOS": numRegistroMinisterios ++; break;
          case "MUNICIPALIDADES":numRegistroMunicipalidades++; break;
          case "ORGANISMOS":numRegistroMunicipalidades++; break;
          case "OTROS":numRegistroMunicipalidades++; break;
          default:;
        }
        totalRegistrosEntidades =  numregistroGobiernoRegional + numRegistroMinisterios + numRegistroMunicipalidades + numRegistroOrganismos + numRegistroOtros;
        var cantidadRegistroEntidades = (numregistroGobiernoRegional*100)/totalRegistrosEntidades;
       // alert(totalRegistros);
        //creo el array de array  que sera la data que se transformara en grafico
        var dataGrafico = [
          ['Descripcion', 'Cantidad'], 
          ['Gobierno Regional',     numregistroGobiernoRegional], 
          ['Ministerios',      numRegistroMinisterios],
          ['Municipalidades',  numRegistroMunicipalidades],
          ['Organismos',  numRegistroOrganismos],
          ['Otros',  numRegistroOtros]
        ]
        //y agregro el array al metodo de googlechart
        var data = google.visualization.arrayToDataTable(dataGrafico);
          var options = {
            title: 'Total de registros de Entidades =' +  " " + totalRegistrosEntidades
          };
          var chart = new google.visualization.PieChart(document.getElementById('piechartEntidades'));
          chart.draw(data, options);
    };
    </script>	
    <div id="piechart" style="width: 900px; height: 500px;"></div>
    <div id="piechartEntidades" style="width: 900px; height: 500px;"></div>
  </body>
</html>